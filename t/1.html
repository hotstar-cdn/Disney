<!DOCTYPE html>
<html>
<head>
  <title>Teacher - Create Test</title>
</head>
<body>
  <h1>Create Test</h1>
  <input type="text" id="testTitle" placeholder="Test Title" /><br><br>
  <textarea id="questions" placeholder="Enter questions in format: Q|OptionA|OptionB|OptionC|CorrectAnswer (one per line)"></textarea><br><br>
  <button onclick="createTest()">Create Test</button>

  <p id="shareLink"></p>

  <script type="module">
    // Firebase setup
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_AUTH_DOMAIN",
      projectId: "YOUR_PROJECT_ID",
      storageBucket: "YOUR_STORAGE_BUCKET",
      messagingSenderId: "YOUR_MSG_SENDER_ID",
      appId: "YOUR_APP_ID"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    async function createTest() {
      const title = document.getElementById("testTitle").value;
      const raw = document.getElementById("questions").value;
      const questions = raw.split('\n').map(line => {
        const [question, a, b, c, correct] = line.split('|');
        return { question, options: [a, b, c], correct };
      });

      const docRef = await addDoc(collection(db, "tests"), {
        title,
        questions
      });

      document.getElementById("shareLink").innerText = `Test Link: 2.html?testId=${docRef.id}`;
    }
  </script>
</body>
</html>
